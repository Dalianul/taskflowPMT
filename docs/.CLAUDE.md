# Documentation - System Architecture & Specifications

## Purpose & Responsibility
Complete technical documentation for TaskFlow project management application covering database design, API specifications, component architecture, and folder structures for both backend and frontend.

## Key Files & Functions

### 1. **database-schema.md** (487 lines)
Complete database design with ERD and table definitions.

**Contents:**
- Entity Relationship Diagram visualization
- 16 table schemas with full column definitions
- Foreign key relationships and constraints
- Indexing strategy for performance
- Cascade rules and data integrity constraints
- Business logic rules and validation
- Migration execution order
- Scaling recommendations (partitioning, archiving, caching)

**Key Tables:**
- users, workspaces, workspace_user (pivot)
- projects, boards, columns, labels
- tasks, task_user (pivot), task_label (pivot)
- comments, attachments
- activities (audit log), notifications
- invitations, personal_access_tokens

**Design Decisions:**
- Denormalized `tasks.board_id` for query performance
- JSON fields for flexible metadata storage
- Composite unique indexes on slugs and pivots
- Cascade deletion for workspace hierarchies
- Restrict deletion for audit trail (created_by)

### 2. **api-endpoints.md** (1,127 lines)
Comprehensive REST API specification with 120+ endpoints.

**Contents:**
- All HTTP endpoints organized by resource
- Request/response examples with full JSON payloads
- Authentication flow (Sanctum token-based)
- Query parameters (pagination, filtering, sorting)
- Error responses with status codes
- WebSocket channel subscriptions
- Real-time event types
- Rate limiting rules

**Endpoint Categories:**
- Authentication (8 endpoints): register, login, logout, password reset, email verification
- Workspaces (10): CRUD, members, invitations, stats
- Projects (7): CRUD, archive/restore
- Boards (6): CRUD, duplicate, set default
- Columns (4): CRUD, reorder
- Labels (4): CRUD
- Tasks (13): CRUD, move, reorder, complete, assign, labels, search
- Comments (4): CRUD, threaded replies
- Attachments (4): upload, download, delete
- Activities (5): timeline feeds
- Notifications (5): list, read, mark all read
- Dashboard (4): stats, my tasks, recent activity
- Search (2): global search, workspace search

**Real-time Channels:**
- `private-user.{userId}` - User notifications
- `private-workspace.{workspaceId}` - Workspace events
- `private-board.{boardId}` - Board updates (task moved, created, etc.)
- `private-task.{taskId}` - Task events (comments, assignments, attachments)

### 3. **backend-folder-structure.md** (576 lines)
Complete Laravel project organization and file structure.

**Contents:**
- Full directory tree with all folders
- File naming conventions
- Controller organization by domain
- Event-driven architecture (Events/Listeners)
- Broadcasting channel definitions
- Service layer organization
- Policy-based authorization
- Request validation classes
- API resource transformers
- Model observers
- Route organization examples
- Environment configuration
- Key design patterns

**Directories Covered:**
- `app/Broadcasting/` - WebSocket channels
- `app/Events/` - Domain events (task, board, comment, etc.)
- `app/Http/Controllers/Api/` - RESTful controllers
- `app/Http/Middleware/` - Custom middleware (access control, activity tracking)
- `app/Http/Requests/` - Form request validation
- `app/Http/Resources/` - JSON response formatting
- `app/Listeners/` - Event handlers
- `app/Models/` - Eloquent models
- `app/Policies/` - Authorization rules
- `app/Services/` - Business logic layer
- `database/migrations/` - Schema definitions
- `routes/` - API, web, channels, console routes
- `tests/` - Feature and unit tests

### 4. **frontend-component-hierarchy.md** (735 lines)
React component architecture and organization.

**Contents:**
- Complete component tree with nesting
- Layout component structure
- Page-level components by route
- Feature-specific components (80+ components)
- Shared/reusable components
- Custom React hooks (25+ hooks)
- State management strategy (Zustand + React Query)
- Query key organization
- Responsive design breakpoints
- Accessibility considerations
- Component composition patterns
- Form validation schemas (Zod)

**Component Categories:**
- **Layouts**: Auth layout, app layout, navigation, sidebar
- **Auth**: Login form, register form, password reset
- **Dashboard**: Stats cards, task lists, activity feed
- **Workspaces**: Cards, grids, headers, member management
- **Projects**: Cards, grids, headers, forms
- **Boards**: Kanban board, columns, filters, settings
- **Tasks**: Task cards, detail modal, forms, metadata
- **Comments**: List, item, form, replies
- **Attachments**: List, item, upload
- **Activity**: Feed, timeline, filters
- **Search**: Global search, modal, results
- **Notifications**: Bell, dropdown, list, items
- **Modals**: Create modals for all resources, confirm dialogs
- **UI**: 20+ Shadcn/ui primitives
- **Forms**: Inputs, selects, pickers, rich text editor
- **Drag & Drop**: Context, draggable, droppable, sortable

**Hook Categories:**
- `hooks/auth/` - Authentication hooks
- `hooks/api/` - React Query data fetching
- `hooks/mutations/` - Data mutation hooks
- `hooks/realtime/` - WebSocket hooks
- `hooks/ui/` - UI interaction hooks
- `hooks/utils/` - Utility hooks (debounce, media query, etc.)

### 5. **frontend-folder-structure.md** (775 lines)
Next.js project organization and configuration.

**Contents:**
- Complete directory tree
- Next.js 15 App Router structure
- TypeScript configuration
- Tailwind CSS setup
- Package dependencies (23 packages)
- Environment variables
- Path aliases
- Route groups (auth, app)
- Component file organization
- Type definitions
- State stores
- API client setup
- Example code snippets

**Key Sections:**
- `src/app/` - App Router pages and layouts
- `src/components/` - All React components
- `src/hooks/` - Custom hooks
- `src/lib/` - Utilities and API client
- `src/stores/` - Zustand stores
- `src/types/` - TypeScript interfaces
- `src/providers/` - React context providers
- `src/schemas/` - Zod validation schemas
- Configuration files (Next.js, TypeScript, Tailwind, Shadcn)
- Package.json with all dependencies

## Dependencies & Relationships

### Internal References
- Database schema → Backend migrations
- API endpoints → Backend controllers + Frontend API hooks
- Backend structure → Laravel implementation guide
- Frontend hierarchy → Component implementation plan
- Frontend structure → Next.js setup guide

### Cross-Document Links
- Migrations reference database schema
- Controllers implement API endpoint specifications
- Frontend components consume API endpoints
- TypeScript types match database models
- WebSocket events documented in API spec

## Common Patterns & Usage

### Using Documentation for Development

**Backend Development:**
1. Reference `database-schema.md` for table relationships
2. Follow `api-endpoints.md` for endpoint specifications
3. Organize code per `backend-folder-structure.md`
4. Implement event-driven patterns as documented

**Frontend Development:**
1. Reference `frontend-component-hierarchy.md` for component structure
2. Follow `frontend-folder-structure.md` for file organization
3. Use `api-endpoints.md` for API integration
4. Match TypeScript types to database schema

**Full-Stack Features:**
1. Start with database schema
2. Create migrations and models
3. Build API endpoints
4. Create frontend hooks and components
5. Connect WebSocket events

### Documentation Updates
When making architectural changes:
- Update schema docs if database changes
- Update API docs if endpoints change
- Update component hierarchy if structure changes
- Update folder structure if organization changes
- Keep all docs in sync

## Architecture Summary

### System Overview
**Application Type:** Project Management (Trello/Asana clone)

**Tech Stack:**
- Backend: Laravel 12, PHP 8.3, MySQL, Redis
- Frontend: Next.js 15, React 19, TypeScript, Tailwind CSS
- Real-time: Laravel Reverb (WebSocket)
- Auth: Laravel Sanctum (token-based)

**Core Features:**
1. User authentication with email verification
2. Multi-workspace collaboration with roles
3. Team invitations with expiring tokens
4. Project management within workspaces
5. Kanban boards with drag-and-drop
6. Customizable columns with WIP limits
7. Tasks with rich metadata (priority, due dates, assignees, labels)
8. Comments with threading support
9. File attachments
10. Activity timeline (audit log)
11. Real-time updates via WebSockets
12. Notification system
13. Global search and filtering
14. Dashboard with statistics

### Data Flow
```
User Action (Frontend)
  ↓
HTTP Request to API (Axios)
  ↓
Laravel Controller (Backend)
  ↓
Service Layer (Business Logic)
  ↓
Eloquent Model (Database)
  ↓
Event Dispatched
  ↓
Listeners Execute:
  - Log Activity
  - Send Notifications
  - Broadcast WebSocket Event
  ↓
API Response (JSON via Resource)
  ↓
React Query Cache Updated
  ↓
UI Re-renders
  ↓
WebSocket Event Received (Echo)
  ↓
Other Connected Clients Updated
```

### Scalability Considerations
- Denormalized fields for common queries
- Redis caching for sessions and frequently accessed data
- Queue system for async operations (emails, notifications)
- WebSocket for efficient real-time updates
- Pagination on all list endpoints
- Indexed foreign keys and composite keys
- Recommendations: Table partitioning (activities by date), read replicas, task archiving

## Quick Reference

### Documentation File Sizes
- `database-schema.md` → 487 lines (complete ERD + 16 tables)
- `api-endpoints.md` → 1,127 lines (120+ endpoints with examples)
- `backend-folder-structure.md` → 576 lines (Laravel organization)
- `frontend-component-hierarchy.md` → 735 lines (80+ components)
- `frontend-folder-structure.md` → 775 lines (Next.js setup)

**Total:** ~3,700 lines of comprehensive documentation

### Key Metrics
- **Database Tables:** 16
- **API Endpoints:** ~120
- **React Components:** 80+
- **Custom Hooks:** 25+
- **Real-time Events:** 16+ types
- **WebSocket Channels:** 4 private channels

### Documentation Standards
- Use markdown formatting
- Include code examples
- Provide request/response samples
- Document rationale for design decisions
- Keep table of contents updated
- Cross-reference related docs
- Include quick start guides

## Related Files
- All docs are in this folder: `D:\ProjectsWebDev\taskflow\docs\`
- Backend implementation: `../backend/`
- Frontend implementation: `../frontend/`
- Root README: `../README.md`
