# TaskFlow - Project Management Application

## Purpose & Responsibility
Full-stack project management application (Trello/Asana clone) with real-time collaboration features. Provides workspace-based team collaboration, Kanban boards with drag-and-drop, task management with rich metadata, and WebSocket-powered live updates.

## Project Overview

### Tech Stack
**Backend:**
- Laravel 12.0 (PHP 8.3)
- MySQL database
- Redis (cache, sessions, queues)
- Laravel Sanctum (API authentication)
- Laravel Reverb (WebSocket server)

**Frontend:**
- Next.js 16 (App Router)
- React 19 with TypeScript 5
- Tailwind CSS 4
- Shadcn/ui components
- TanStack React Query + Zustand
- Laravel Echo + Pusher

### Core Features
1. **User Authentication** - Register, login, password reset, email verification
2. **Workspaces** - Team spaces with role-based access (Owner, Admin, Member, Viewer)
3. **Projects** - Organize work within workspaces
4. **Kanban Boards** - Visual task management with drag-and-drop
5. **Tasks** - Rich task cards with priority, due dates, assignees, labels
6. **Collaboration** - Comments, attachments, activity timeline
7. **Real-time Updates** - WebSocket synchronization across users
8. **Notifications** - In-app notification system
9. **Search** - Global search across all resources
10. **Dashboard** - Personal workspace with stats and recent activity

## Key Files & Directories

### Root Level
- `README.md` - Project documentation (basic)
- `backend/` - Laravel API application
- `frontend/` - Next.js web application
- `docs/` - Complete technical documentation (5 files, ~3,700 lines)

### Backend (`backend/`)
- `app/` - Application code (models, controllers, services)
- `database/migrations/` - 14 schema migrations (2025_12_16_*)
- `config/` - Configuration files (sanctum, reverb, broadcasting)
- `routes/api.php` - API endpoint definitions (to be created)
- `.env` - Environment variables (DB: taskflow, Redis configured)

### Frontend (`frontend/`)
- `src/app/` - Next.js App Router pages
- `src/components/` - React components (ui/, layouts/, features/)
- `src/hooks/` - Custom React hooks (api/, mutations/, realtime/)
- `src/lib/` - Utilities (API client, Echo, query keys)
- `src/types/` - TypeScript type definitions
- `.env.local` - Environment variables (API URL, WebSocket config)

### Documentation (`docs/`)
- `database-schema.md` - Complete ERD and table definitions (487 lines)
- `api-endpoints.md` - REST API specification with ~120 endpoints (1,127 lines)
- `backend-folder-structure.md` - Laravel project organization (576 lines)
- `frontend-component-hierarchy.md` - React component architecture (735 lines)
- `frontend-folder-structure.md` - Next.js setup and organization (775 lines)

## Dependencies & Relationships

### Inter-Project Communication
```
Frontend (Next.js)
  ‚Üì HTTP/REST
Backend API (Laravel)
  ‚Üì WebSocket
Frontend (Laravel Echo)
  ‚Üì Database
MySQL
  ‚Üì Cache/Queue
Redis
```

### Environment Configuration

**Backend (.env):**
```env
APP_URL=http://taskflow-backend.test
DB_DATABASE=taskflow
DB_USERNAME=root
DB_PASSWORD=admin123
REDIS_HOST=127.0.0.1
BROADCAST_DRIVER=reverb
REVERB_HOST=localhost
REVERB_PORT=8080
```

**Frontend (.env.local):**
```env
NEXT_PUBLIC_API_URL=http://taskflow-backend.test/api
NEXT_PUBLIC_REVERB_HOST=localhost
NEXT_PUBLIC_REVERB_PORT=8080
NEXT_PUBLIC_REVERB_APP_KEY=taskflow-key-local
```

## Common Patterns & Usage

### Starting Development Environment

**Backend:**
```bash
cd backend
composer install                 # Install dependencies
php artisan key:generate         # Generate app key
php artisan migrate              # Run migrations
php artisan serve                # Start API server (port 8000)
php artisan reverb:start        # Start WebSocket server (port 8080)
php artisan queue:listen        # Process background jobs
```

**Frontend:**
```bash
cd frontend
npm install                      # Install dependencies
npm run dev                      # Start dev server (port 3000)
```

### Development Workflow

**Full-Stack Feature Development:**
1. Design database schema (reference `docs/database-schema.md`)
2. Create migration: `php artisan make:migration`
3. Create model: `php artisan make:model -mfrc`
4. Build API endpoint (controller, request, resource)
5. Add route to `routes/api.php`
6. Create TypeScript types in `frontend/src/types/`
7. Build API hook in `frontend/src/hooks/api/`
8. Create React components
9. Wire up WebSocket events if real-time needed
10. Test end-to-end

**Backend API Development:**
```bash
php artisan make:model Task -mfrc     # Model + migration + factory + resource + controller
php artisan make:request StoreTaskRequest
php artisan make:policy TaskPolicy
php artisan route:list                 # View all routes
php artisan test                       # Run tests
```

**Frontend Component Development:**
```bash
npx shadcn-ui@latest add button       # Add UI components
npm run dev                            # Hot reload development
npm run build                          # Production build
npm run lint                           # ESLint check
```

### Testing
```bash
# Backend
cd backend
php artisan test
php artisan test --filter TaskTest

# Frontend
cd frontend
npm run lint
npm run build  # Type checking
```

## Architecture Patterns

### Backend (Laravel)
- **Event-Driven:** Events/Listeners for real-time updates and logging
- **Service Layer:** Complex business logic in service classes
- **Policy-Based Auth:** Resource authorization via policies
- **Resource Pattern:** Consistent API responses via resources
- **Observer Pattern:** Automatic activity logging on model events

### Frontend (Next.js)
- **Server Components:** Default for better performance
- **Client Components:** Forms, real-time, interactivity
- **React Query:** Server state management with caching
- **Zustand:** Client state (auth, UI, filters)
- **Custom Hooks:** Reusable logic and API integration

### Real-time Architecture
```
User Action
  ‚Üì
API Request ‚Üí Controller ‚Üí Service ‚Üí Model ‚Üí Event
  ‚Üì                                           ‚Üì
Response ‚Üê Resource ‚Üê Policy            Listener
                                             ‚Üì
                                      Broadcast (Reverb)
                                             ‚Üì
                                        Laravel Echo
                                             ‚Üì
                                      Frontend Update
```

## Current State

### ‚úÖ Completed
- Project structure initialized
- Backend: Laravel 12 installed, configured (Sanctum, Reverb, Redis)
- Frontend: Next.js 16 installed, Shadcn/ui components added
- Database schema designed (16 tables, 14 migrations)
- Complete API specification documented (~120 endpoints)
- Component hierarchy designed (80+ components)
- Environment configured for local development
- Documentation created (5 comprehensive files)

### üöß In Progress / Pending

**Backend:**
- [ ] Create Eloquent models (11 models needed)
- [ ] Build API controllers (~27 controllers)
- [ ] Implement API routes (~120 endpoints)
- [ ] Create form request validators
- [ ] Build API resources for JSON responses
- [ ] Implement authorization policies
- [ ] Create events and listeners for real-time
- [ ] Build service layer classes
- [ ] Write feature and unit tests

**Frontend:**
- [ ] Create authentication pages (login, register, password reset)
- [ ] Build app layout (navigation, sidebar)
- [ ] Create workspace management UI
- [ ] Build Kanban board with drag-and-drop
- [ ] Implement task detail modal
- [ ] Create comment system
- [ ] Build notification center
- [ ] Implement global search
- [ ] Create dashboard with stats
- [ ] Set up API client and React Query hooks
- [ ] Configure Laravel Echo WebSocket client
- [ ] Define TypeScript types for all models

### üìù Next Steps Priority
1. Run database migrations: `php artisan migrate`
2. Create core Eloquent models: User, Workspace, Project, Board, Task
3. Build authentication API endpoints
4. Create frontend login/register pages
5. Set up API client with Axios interceptors
6. Build workspace listing and creation UI
7. Implement board and task management
8. Connect WebSocket for real-time updates

## Quick Reference

### Important URLs
- **Frontend:** http://localhost:3000
- **Backend API:** http://localhost:8000/api
- **WebSocket:** ws://localhost:8080
- **Backend App:** http://taskflow-backend.test

### Database
- **Type:** MySQL
- **Database:** taskflow
- **User:** root / admin123
- **Tables:** 16 custom + 9 Laravel system = 25 total

### Key Commands
```bash
# Backend
php artisan serve                    # Start API server
php artisan reverb:start            # Start WebSocket
php artisan migrate                 # Run migrations
php artisan route:list              # List all routes
php artisan tinker                  # Interactive console

# Frontend
npm run dev                          # Start dev server
npm run build                        # Production build
npx shadcn-ui@latest add [component] # Add UI component
```

### Documentation Quick Links
- Database design: `docs/database-schema.md`
- API specification: `docs/api-endpoints.md`
- Backend structure: `docs/backend-folder-structure.md`
- Component design: `docs/frontend-component-hierarchy.md`
- Frontend setup: `docs/frontend-folder-structure.md`

## Folder Context Files

### Available Context Files
- `/.CLAUDE.md` - This file (root project context)
- `/backend/.CLAUDE.md` - Laravel API backend context
- `/frontend/.CLAUDE.md` - Next.js frontend context
- `/docs/.CLAUDE.md` - Documentation overview
- `/backend/database/migrations/.CLAUDE.md` - Database migrations context

### Context Engineering Benefits
- **80% Context Reduction:** From 30-50k tokens to 3-8k tokens per task
- **Focused Knowledge:** Load only relevant folder contexts
- **Scalable Architecture:** Grows with project complexity
- **Living Documentation:** Contexts stay current with code

## Related Files
- Root README: `./README.md`
- Complete documentation: `./docs/` (5 files)
- Backend implementation: `./backend/`
- Frontend implementation: `./frontend/`
