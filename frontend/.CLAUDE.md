# Frontend - Next.js Application (TaskFlow)

## Purpose & Responsibility
Next.js 16 frontend application providing an interactive Kanban-style project management UI with real-time collaboration features. Consumes REST API from Laravel backend and establishes WebSocket connections for live updates.

## Tech Stack
- **Framework**: Next.js 16.0.10 (App Router)
- **UI Library**: React 19.2.1
- **Language**: TypeScript 5
- **Styling**: Tailwind CSS 4 (with OKLCh colors)
- **Components**: Shadcn/ui (Radix UI primitives)
- **State Management**: Zustand + TanStack React Query
- **Forms**: React Hook Form + Zod validation
- **Drag & Drop**: @hello-pangea/dnd (Beautiful DnD)
- **Real-time**: Laravel Echo + Pusher
- **HTTP Client**: Axios
- **Icons**: Lucide React, Heroicons

## Key Files & Functions

### Configuration
- `next.config.ts` - Next.js configuration (minimal, uses defaults)
- `tsconfig.json` - TypeScript config with strict mode, path aliases (`@/*`)
- `components.json` - Shadcn/ui setup (new-york style, Lucide icons)
- `.env.local` - Environment variables (API URL, Reverb WebSocket config)

### Core Application Structure
- `src/app/layout.tsx` - Root layout with providers, fonts (Geist)
- `src/app/page.tsx` - Landing/home page (currently boilerplate)
- `src/app/(auth)/` - Auth route group: login, register, password reset
- `src/app/(app)/` - Protected app routes: dashboard, workspaces, boards
- `src/middleware.ts` - Next.js middleware for auth guards (to be created)

### Component Library
- `src/components/ui/` - Shadcn/ui primitives (button, input, card, dialog, dropdown)
- `src/components/forms/` - Form components (to be created)
- `src/components/layouts/` - Layout components (to be created)
- `src/components/[feature]/` - Feature components: workspaces, boards, tasks (to be created)

### State & Data Management
- `src/stores/` - Zustand stores: auth, workspace, board, UI (to be created)
- `src/hooks/api/` - React Query hooks for data fetching (to be created)
- `src/hooks/mutations/` - Mutation hooks for updates (to be created)
- `src/lib/api/` - Axios client and API functions (to be created)
- `src/lib/query-keys.ts` - Centralized React Query cache keys (to be created)

### Type Definitions
- `src/types/` - TypeScript interfaces matching backend models (to be created)
  - User, Workspace, Project, Board, Task, Comment, etc.

### Utilities
- `src/lib/utils.ts` - Helper functions (cn classname merger)
- `src/lib/echo.ts` - Laravel Echo WebSocket setup (to be created)
- `src/lib/date.ts` - Date formatting utilities (to be created)

## Dependencies & Relationships

### Core Dependencies
```json
"next": "16.0.10"                      // Framework
"react": "19.2.1"                      // UI library
"@tanstack/react-query": "5.90.12"    // Server state
"zustand": "5.0.9"                     // Client state
"axios": "1.13.2"                      // HTTP client
"laravel-echo": "2.2.6"                // WebSocket client
"react-hook-form": "7.68.0"            // Forms
"zod": "4.2.1"                         // Validation
"@hello-pangea/dnd": "18.0.1"          // Drag & drop
```

### Integrates With
- **Backend API**: Laravel at `http://taskflow-backend.test/api`
- **WebSocket**: Reverb at `ws://localhost:8080`
- **Authentication**: Sanctum token-based auth

### External Services
- None currently (all backend-driven)

## Styling System

### Tailwind 4 with OKLCh Colors
- `src/app/globals.css` - Theme variables, animations, dark mode
- 30+ CSS custom properties for theming
- Color palette: primary, secondary, accent, destructive, sidebar, chart
- Dark mode: `.dark` class selector
- Radius scales: sm ‚Üí 4xl (8 sizes)

### Component Variants
- Uses `class-variance-authority` for type-safe variants
- Tailwind-merge for classname conflict resolution
- clsx for conditional classes

## Common Patterns & Usage

### Starting Development
```bash
cd frontend
npm run dev          # Development server (http://localhost:3000)
npm run build        # Production build
npm run start        # Production server
npm run lint         # ESLint
```

### Adding UI Components
```bash
npx shadcn-ui@latest add button      # Add button component
npx shadcn-ui@latest add dialog      # Add dialog component
npx shadcn-ui@latest add calendar    # Add calendar component
```

### Creating Pages
```typescript
// src/app/dashboard/page.tsx
export default function DashboardPage() {
  return <div>Dashboard content</div>
}

// src/app/boards/[boardId]/page.tsx
export default function BoardPage({ params }: { params: { boardId: string } }) {
  return <div>Board {params.boardId}</div>
}
```

### Using API Hooks (Pattern)
```typescript
// src/hooks/api/use-board.ts
import { useQuery } from '@tanstack/react-query'
import { getBoard } from '@/lib/api/boards'

export function useBoard(boardId: number) {
  return useQuery({
    queryKey: ['boards', boardId],
    queryFn: () => getBoard(boardId),
  })
}

// In component
const { data: board, isLoading } = useBoard(1)
```

### Real-time WebSocket (Pattern)
```typescript
// src/hooks/realtime/use-board-channel.ts
import { useEffect } from 'react'
import echo from '@/lib/echo'

export function useBoardChannel(boardId: number) {
  useEffect(() => {
    const channel = echo.private(`board.${boardId}`)

    channel
      .listen('TaskCreated', (event) => {
        console.log('New task:', event.task)
      })
      .listen('TaskMoved', (event) => {
        console.log('Task moved:', event)
      })

    return () => {
      channel.stopListening('TaskCreated')
      channel.stopListening('TaskMoved')
    }
  }, [boardId])
}
```

## Current State

### ‚úÖ Completed
- Next.js 16 with App Router configured
- TypeScript with strict mode enabled
- Tailwind CSS 4 with dark mode support
- Shadcn/ui components installed (button, input, card, dialog, dropdown)
- State management dependencies installed (React Query + Zustand)
- Real-time dependencies installed (Laravel Echo + Pusher)
- Form dependencies installed (React Hook Form + Zod)
- Drag-and-drop library installed
- Environment variables configured

### ‚ö†Ô∏è In Progress / Pending
- [ ] Create authentication pages (login, register)
- [ ] Build protected route layouts with navigation
- [ ] Create workspace management UI
- [ ] Build Kanban board with drag-and-drop
- [ ] Implement task cards with all metadata
- [ ] Create comment system with threading
- [ ] Build notification center
- [ ] Implement global search
- [ ] Add activity timeline
- [ ] Create dashboard with stats
- [ ] Set up API client with Axios interceptors
- [ ] Configure Laravel Echo WebSocket connection
- [ ] Build React Query hooks for all endpoints
- [ ] Create Zustand stores for app state
- [ ] Define TypeScript types for all models

### üìù Notes
- Use Server Components where possible for better performance
- Client Components needed for: forms, real-time, drag-and-drop
- All API calls should use React Query for automatic caching
- WebSocket events should trigger React Query invalidation
- Form validation schemas with Zod for type safety
- Mobile-first responsive design (sm, md, lg, xl breakpoints)

## Architecture Patterns

### Route Organization
```
app/
‚îú‚îÄ‚îÄ (auth)/          # Public auth pages
‚îú‚îÄ‚îÄ (app)/           # Protected app pages
‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx   # App shell (nav + sidebar)
‚îÇ   ‚îú‚îÄ‚îÄ dashboard/
‚îÇ   ‚îú‚îÄ‚îÄ workspaces/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ [slug]/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ settings/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ projects/
‚îÇ   ‚îî‚îÄ‚îÄ boards/
‚îÇ       ‚îî‚îÄ‚îÄ [boardId]/
```

### Component Composition
```typescript
// Flexible slot-based composition
<Card>
  <CardHeader>
    <CardTitle>Task Title</CardTitle>
    <CardAction>...</CardAction>
  </CardHeader>
  <CardContent>
    <TaskDetails />
  </CardContent>
  <CardFooter>
    <TaskMeta />
  </CardFooter>
</Card>
```

### State Management Strategy
- **Server State**: React Query (API data, caching, refetching)
- **Client State**: Zustand (auth, UI state, filters)
- **Form State**: React Hook Form (isolated form state)
- **URL State**: Next.js router (search params, dynamic routes)

### Type Safety
- All API responses have TypeScript interfaces
- Zod schemas for runtime validation + type inference
- Strict null checks enabled
- Path aliases for clean imports (`@/components`, `@/lib`)

## Quick Reference

### Path Aliases
```typescript
import { Button } from '@/components/ui/button'
import { cn } from '@/lib/utils'
import { useAuth } from '@/hooks/auth/use-auth'
import type { Task } from '@/types/task'
```

### Environment Variables
```env
NEXT_PUBLIC_API_URL=http://taskflow-backend.test/api
NEXT_PUBLIC_REVERB_APP_KEY=taskflow-key-local
NEXT_PUBLIC_REVERB_HOST=localhost
NEXT_PUBLIC_REVERB_PORT=8080
NEXT_PUBLIC_REVERB_SCHEME=http
```

### Color System (Tailwind)
- `bg-background` / `text-foreground` - Base colors
- `bg-primary` / `text-primary-foreground` - Brand colors
- `bg-card` / `text-card-foreground` - Card backgrounds
- `bg-destructive` / `text-destructive-foreground` - Error states
- `border-border` - Border colors
- Use `.dark` class for dark mode

### Responsive Breakpoints
```css
sm: 640px   /* Mobile landscape */
md: 768px   /* Tablet */
lg: 1024px  /* Desktop */
xl: 1280px  /* Large desktop */
2xl: 1536px /* Extra large */
```

## Related Documentation
- Component hierarchy: `../docs/frontend-component-hierarchy.md`
- Folder structure: `../docs/frontend-folder-structure.md`
- API endpoints: `../docs/api-endpoints.md`
